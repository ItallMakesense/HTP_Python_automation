"""
On machine A create a script that every 3 minutes adds a random string with a length of 10 symbols to $HOME/sync/random_string.log

Make sure this string also starts with current system time on the Virtual machine (HR:MIN:SEC) format

If the last random string ends with even digit – print out “EVEN!” and the number itself to the current console, if it is odd or a letter – print “ODD!” and the number itself.

On machine B create a script and that every 2 minutes scans machine A for content in $HOME/sync directory, and copies all to self $HOME/sync directory.


The suggested tools are: grep, cat, cut, tail, head, ssh, wc… (can also try to use sed / awk, but that is not necessary).


Linux Fundamentals: http://rus-linux.net/MyLDP/BOOKS/Linux_Foundations/toc.html

The BASH guide: http://rus-linux.net/MyLDP/BOOKS/abs-guide/flat/abs-book.html
"""

1. As you see on the first two screenshots, VM's are synchronized.

2. Create "sync" directory:
$ sudo mkdir ~/sync

3. Create script file:
$ gedit script_1.sh

4. Paste the code below:

#!/bin/sh

while true
do
date +%T | tr -d '\n' >> $HOME/sync/random_string.log
string=$(head /dev/urandom | tr -dc 'a-zA-Z0-9' | head -c 10)
echo -n $string >> $HOME/sync/random_string.log
echo >> $HOME/sync/random_string.log
string_S=$(echo -n $string | tail -c 1)
if [[ "$string_S" -ne 'a-zA-Z' ]]
then
num=$(expr $string_S % 2)
if [[ $num -eq 0 ]]
then echo "EVEN!"; echo $string_S
elif [[ $num -ne 0 ]]
then echo "ODD!"; echo $string_S
fi
elif [[ "$string_S" -eq 'a-zA-Z' ]]
then echo "ODD!"; echo $string_S
fi
sleep 180
done

# A 'date' command with '%T' option makes .log input to start with current time.
# Further is just deleting of new line symbol at the end of 'date' output.
# A 'string' variable contains commands making random string with 10 symbols
# (first 10 lines of randomly generated file sorting by 'tr' command,
# which passes only needed symbols, and in the end cuts all to 10 symbols).
# Next is just appending of this line to .log (echo \n ...; echo ...).
# A 'string_S' variable contains the last symbol of $string var (simply by "tailing" the last symbol).
# All that remains in code - is our conditions...
# Except 'sleep' - after that it's just waits for 3 minutes :).

5. Save the file.

6. This script can be terminated by a command "bash script_1.sh" (it will work till "ctrl+c" or closing terminal if OS is ubuntu).
Either it can be placed in the background as daemon by a command "bash script_1.sh &".
Even more - it can start everytime the terminal opens: use the command "echo >> ~/.bashrc; echo 'bash ~/script_1.sh &' >> ~/.bashrc"

7. Go to other VM's $HOME directory.

8. Create "sync" directory here:
$ sudo mkdir ~/sync

9. Create script file:
$ gedit script_2.sh

# It can be any other editor (if other linux OS).

10. Paste the code below:

#!/bin/sh

while true
do
scp -r user@ip:~/sync ~/
sleep 120
done

# In my case user is 'virtual'
# and ip is '192.168.56.1'.

11. Now same as in point 6: "bash script_2.sh" or "bash script_2.sh &" or "echo >> ~/.bashrc; echo 'bash ~/script_2.sh &' >> ~/.bashrc"

12. Result is on the 3rd screenshot.
